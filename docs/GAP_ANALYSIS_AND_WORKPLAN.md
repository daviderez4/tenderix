# TENDERIX - ניתוח פערים ותכנית עבודה
**תאריך:** 17 ינואר 2026
**גרסה:** 3.0

---

## סקירת מצב נוכחי

### מה קיים ועובד

#### Frontend (React + TypeScript + Vite)
| דף | סטטוס | הערות |
|---|---|---|
| Dashboard | עובד | מציג רשימת מכרזים, סטטיסטיקות תנאי סף |
| NewTenderPage | עובד | יצירת מכרז חדש, העלאת PDF, חילוץ טקסט |
| TenderIntakePage | עובד | עריכת פרטי מכרז (P1) |
| GatesPage | עובד | הצגת תנאי סף, כפתור ניתוח AI |
| CompetitorsPage | עובד | ניהול מתחרים, טעינת נתוני דוגמה |
| AnalysisPage | קיים | ניתוח כללי |
| DecisionPage | קיים | דף החלטה Go/No-Go |
| CompanyProfilePage | קיים | פרופיל חברה |

#### Backend & Infrastructure
| רכיב | סטטוס | הערות |
|---|---|---|
| Supabase DB | עובד | סכמה מלאה V3 מותקנת |
| n8n Webhooks | עובד חלקית | חילוץ תנאי סף עם timeout לפעמים |
| MCP Server | עובד | gate-extractor עם 4 סוכנים |
| PDF.js | עובד | חילוץ טקסט צד-לקוח |

#### API Functions (tenderix.ts)
| פונקציה | סטטוס |
|---|---|
| api.tenders.list/get/create/update | עובד |
| api.getGateConditions | עובד |
| api.saveGateConditions | עובד |
| api.getGateSummary | עובד |
| api.getBOQItems | עובד |
| api.getCompetitors | עובד |
| api.createCompetitor | עובד |
| api.deleteCompetitor | עובד |
| api.populateSampleCompetitors | עובד |

---

## פערים זוהו (Gap Analysis)

### P1: קליטת מכרז - חסרים

| מודול | תיאור | עדיפות | מורכבות |
|---|---|---|---|
| 1.1.5 | ניהול גרסאות מסמכים (הבהרות) | גבוהה | בינונית |
| 1.4 | חילוץ הגדרות אוטומטי | בינונית | גבוהה |
| 1.5 | זיהוי קטגוריה אוטומטי | נמוכה | בינונית |
| 1.6 | ניתוח מכרז קודם | נמוכה | גבוהה |

### P2: תנאי סף - חסרים

| מודול | תיאור | עדיפות | מורכבות |
|---|---|---|---|
| 2.4 | פרשנות הגדרות (מילון טכני) | גבוהה | גבוהה |
| 2.5 | אפשרויות חלופיות | בינונית | בינונית |
| 2.6 | התאמה אוטומטית לתיק פרויקטים | גבוהה | גבוהה |
| 2.7 | הפקת שאלות הבהרה | בינונית | בינונית |
| 2.8 | אופטימיזציה (Ido) - שימוש חוזר בפרויקטים | גבוהה | גבוהה |
| 2.9 | דוח סיכום Gate Summary | קיים חלקית | נמוכה |
| 2.10 | עדכון לאחר הבהרות | נמוכה | בינונית |

### P3: מפרט וכתב כמויות - חסרים

| מודול | תיאור | עדיפות | מורכבות |
|---|---|---|---|
| 3.1 | חילוץ פריטי מפרט | גבוהה | גבוהה |
| 3.2 | ניתוח כתב כמויות | גבוהה | גבוהה |
| 3.3 | היקף עבודה ומשימות נסתרות | בינונית | גבוהה |
| 3.4 | ניתוח חוזה | בינונית | בינונית |
| 3.5 | זיהוי אי-התאמות spec vs boq | בינונית | בינונית |

### P4: מתחרים - חסרים

| מודול | תיאור | עדיפות | מורכבות |
|---|---|---|---|
| 4.1 | מעקב היסטוריית הצעות | בינונית | בינונית |
| 4.2 | חיזוי מי יגיש | נמוכה | גבוהה |
| 4.3 | ניתוח מחירי שוק | בינונית | גבוהה |
| 4.4 | אסטרטגיית מחיר | נמוכה | גבוהה |

### מודול 2.0: פרופיל חברה - חסרים

| רכיב | תיאור | עדיפות | מורכבות |
|---|---|---|---|
| תיק פרויקטים | ניהול פרויקטים שבוצעו | גבוהה | בינונית |
| הסמכות | ניהול תעודות ורישיונות | גבוהה | נמוכה |
| כח אדם | ניהול אנשי מפתח | בינונית | בינונית |
| נתונים פיננסיים | מחזורים שנתיים | בינונית | נמוכה |

### Core Components - חסרים

| רכיב | תיאור | עדיפות | מורכבות |
|---|---|---|---|
| C1 | עקיבות מלאה (Traceability) | קיים חלקית | - |
| C2 | מילון טכני | חסר | גבוהה |
| C3 | אופטימיזציה - מניעת כפילויות | חסר | גבוהה |
| C4 | סגירת פערים | חסר | בינונית |
| C5 | שאלות הבהרה אסטרטגיות | חסר | בינונית |

---

## תכנית עבודה מפורטת

### שלב 1: תיקונים דחופים (Sprint 1)
**מטרה:** המערכת עובדת end-to-end

- [ ] תיקון timeout בחילוץ תנאי סף (n8n workflow)
- [ ] וידוא כל הפונקציות ב-API עובדות
- [ ] בדיקה שיצירת מכרז -> תנאי סף עובד חלק
- [ ] הוספת loading states ו-error handling

### שלב 2: פרופיל חברה (Sprint 2)
**מטרה:** בניית תשתית לבדיקת עמידה בתנאים

- [ ] UI לניהול תיק פרויקטים
- [ ] UI לניהול הסמכות ורישיונות
- [ ] UI לניהול אנשי מפתח
- [ ] UI לנתונים פיננסיים (מחזורים)
- [ ] חיבור לטבלאות DB קיימות

### שלב 3: התאמת תנאי סף (Sprint 3)
**מטרה:** בדיקה אוטומטית של עמידה בתנאים

- [ ] אלגוריתם התאמה (gate matching)
- [ ] UI להצגת התאמות
- [ ] זיהוי פערים אוטומטי
- [ ] הצעות לסגירת פערים

### שלב 4: מפרט וכתב כמויות (Sprint 4)
**מטרה:** ניתוח מלא של הדרישות הטכניות

- [ ] חילוץ פריטי מפרט
- [ ] ניתוח כתב כמויות
- [ ] UI לעריכת מחירים
- [ ] חישוב סה"כ והערכת רווחיות

### שלב 5: החלטה (Sprint 5)
**מטרה:** תמיכה בהחלטת Go/No-Go

- [ ] דוח סיכום מלא
- [ ] תרחישי מחיר
- [ ] המלצה אוטומטית
- [ ] ייצוא לאקסל/PDF

---

## משימות מיידיות (עכשיו)

1. **Commit לגיטהאב** - גיבוי כל השינויים
2. **Deploy לפרודקשן** - וידוא התאמה לדב
3. **בדיקת end-to-end** - יצירת מכרז מלא

---

## סכמת Database - טבלאות קיימות

```
organizations          - חברות (קיים ועובד)
users                  - משתמשים (קיים)
tenders               - מכרזים (קיים ועובד)
tender_documents      - מסמכים (קיים)
tender_definitions    - הגדרות (קיים, לא בשימוש)
gate_conditions       - תנאי סף (קיים ועובד)
gate_condition_matches - התאמות (קיים, לא בשימוש)
gate_conditions_summary - סיכום (קיים ועובד)
company_projects      - פרויקטים (קיים, לא בשימוש)
company_financials    - פיננסים (קיים, לא בשימוש)
company_certifications - הסמכות (קיים, לא בשימוש)
company_personnel     - כח אדם (קיים, לא בשימוש)
competitors           - מתחרים (קיים ועובד)
tender_competitors    - מתחרים למכרז (קיים)
boq_items            - כתב כמויות (קיים ועובד)
spec_items           - פריטי מפרט (קיים, לא בשימוש)
clarification_questions - שאלות הבהרה (קיים, לא בשימוש)
technical_dictionary  - מילון טכני (קיים, לא בשימוש)
```

---

## קבצי Frontend עיקריים

```
frontend/
├── src/
│   ├── api/
│   │   ├── config.ts      - הגדרות API (Supabase, n8n)
│   │   └── tenderix.ts    - כל ה-API functions (~3200 שורות)
│   ├── pages/
│   │   ├── Dashboard.tsx
│   │   ├── NewTenderPage.tsx
│   │   ├── TenderIntakePage.tsx
│   │   ├── GatesPage.tsx
│   │   ├── CompetitorsPage.tsx
│   │   ├── AnalysisPage.tsx
│   │   ├── DecisionPage.tsx
│   │   └── CompanyProfilePage.tsx
│   └── components/
│       ├── Sidebar.tsx
│       ├── Login.tsx
│       ├── Loading.tsx
│       └── StatusBadge.tsx
```

---

## Environment Variables

```env
VITE_SUPABASE_URL=https://rerfjgjwjqodevkvhkxu.supabase.co
VITE_SUPABASE_KEY=<service_role_key>
VITE_WEBHOOK_BASE=https://daviderez.app.n8n.cloud/webhook
VITE_OCR_ENABLED=false
```

---

## הערות חשובות

1. **API Key** - משתמש ב-service_role key (לא anon) כי צריך write access
2. **Session-based Org** - כל session מקבל org_id ייחודי
3. **PDF חילוץ** - מתבצע בצד לקוח עם PDF.js
4. **תנאי סף** - מערכת 4 סוכנים ב-MCP server (gate-extractor)
5. **Timeout** - לפעמים n8n webhook לא מגיב בזמן

---

## ליצור קשר

שאלות? בעיות? פתח issue ב-GitHub או פנה לצוות הפיתוח.
